<%- include('partials/header'); -%>
    <link rel="stylesheet" href="/create.css">
    <div class="container contact-form">
        <div class="contact-image">
            <img src="https://image.ibb.co/kUagtU/rocket_contact.png" alt="rocket_contact" />
        </div>
        <form id="<%= blog._id %>">
            <h3>Update <%= blog.title %> </h3>
            <div class="row">
                <div class="col-md-6">
                    <div class="form-group m-2">
                        <input type="text" name="title" id="title" class="form-control" value="<%= blog.title.trim() %> " placeholder="Title*" required />
                        <p class="error"></p>
                    </div>
                    <div class="form-group m-2">
                        <input type="text" name="description" id="description" value="<%= blog.description.trim() %> " class="form-control"
                            placeholder="Description*" required />
                    </div>
                    <br>
                    <div class="form-group m-2">
                        <input type="submit" name="btnSubmit" class="btnContact" value="Update" />
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="form-group">
                        <textarea name="content" id="content" class="form-control" placeholder="Blog Content*" 
                            style="width: 100%; height: 150px;"><%= blog.content.trim() %></textarea>
                    </div>
                </div>
            </div>
        </form>
    </div>
    <script>
        const form = document.querySelector('form');
        form.addEventListener('submit', async(event) => {
            event.preventDefault();
            const title = form.title.value.trim();
            const description = form.description.value.trim();
            const content = form.content.value.trim();
            try{
                const res = await fetch(`/blogs/detail/update/${form.id}`, {
                    method: 'post',
                    body: JSON.stringify({ title, description, content }),
                    headers: { 'Content-Type': 'application/json' },
                });
                const data = await res.json();
                if (data.errors) {
                    const errorField = document.querySelector('.error');
                    errorField.textContent = data.errors;
                } else {
                    location.assign(data.redirect);
                }
            } catch(err){
                console.log(err);
            }
        });
    </script>
<%- include('partials/footer'); -%>