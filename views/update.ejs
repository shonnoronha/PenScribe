<%- include('partials/header'); -%>
<form id="<%= blog._id %>">
    <div class="form-group text-center mx-5 py-3">
        <label for="title">TITLE</label>
        <input type="text" class="form-control" id="title" name="title" placeholder="title..." value="<%= blog.title.trim() %> ">
        <p class="error"></p>
    </div>

    <div class="form-group text-center mx-5 py-3">
        <label for="description">DESCRIPTION</label>
        <input type="text" value="<%= blog.description.trim() %> " class="form-control" id="description" name="description" placeholder="description...">
    </div>

    <div class="form-group text-center mx-5 py-3">
        <label for="content">CONTENT</label>
        <textarea class="form-control" id="content" name="content" rows="3"><%= blog.content.trim() %>
        </textarea>
    </div>

    <div class="form-group text-center mx-5 py-3">
        <button type="submit" class="btn btn-outline-success">Submit</button>
    </div>
    
</form>

<script>
    const form = document.querySelector('form');
    form.addEventListener('submit', async(event) => {
        event.preventDefault();
        const title = form.title.value.trim();
        const description = form.description.value.trim();
        const content = form.content.value.trim();
        try{
            const res = await fetch(`/blogs/detail/update/${form.id}`, {
                method: 'post',
                body: JSON.stringify({ title, description, content }),
                headers: { 'Content-Type': 'application/json' },
            });
            const data = await res.json();
            if (data.errors) {
                const errorField = document.querySelector('.error');
                errorField.textContent = data.errors;
            } else {
                location.assign(data.redirect);
            }
        } catch(err){
            console.log(err);
        }
    });
</script>
<%- include('partials/footer'); -%>
